# üîê Security Checklist - CRM AI Agent

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ—Ä—ã
- [x] **`.gitignore` —Å–æ–∑–¥–∞–Ω** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–º–º–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- [x] **`.env.example` —Å–æ–∑–¥–∞–Ω** - —à–∞–±–ª–æ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —à–∞—Ä–∏–Ω–≥–∞
- [x] **Auth Middleware** - —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- [x] **Rate Limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ (20 req/min)
- [x] **Environment validation** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

## ‚ö†Ô∏è –í–ê–ñ–ù–û - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –°–ï–ô–ß–ê–°

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Git —Å—Ç–∞—Ç—É—Å
```bash
cd c:\D\VibeCode\CRM_vibe
git status
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `.env` –≤ —Å–ø–∏—Å–∫–µ:**
```bash
# –û–ü–ê–°–ù–û! –§–∞–π–ª –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è Git
git rm --cached .env
git commit -m "Remove .env from tracking"
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å—Ç–æ—Ä–∏—é:**
```bash
git log --all --full-history -- .env
```

**–ï—Å–ª–∏ .env –±—ã–ª –∑–∞–∫–æ–º–º–∏—á–µ–Ω - –ö–†–ò–¢–ò–ß–ù–û:**
1. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –í–°–ï —Ç–æ–∫–µ–Ω—ã:
   - Telegram Bot Token (—á–µ—Ä–µ–∑ @BotFather)
   - Google API Key (—á–µ—Ä–µ–∑ Google Cloud Console)
   - AmoCRM Client Secret (—á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
2. –£–¥–∞–ª–∏—Ç–µ .env –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏:
   ```bash
   git filter-branch --force --index-filter \
     "git rm --cached --ignore-unmatch .env" \
     --prune-empty --tag-name-filter cat -- --all
   ```

### 2. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
# –í .env –¥–æ–±–∞–≤—å—Ç–µ:
ALLOWED_TG_IDS=580500972,123456789,987654321
```

## üìã –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–µ–Ω–æ

### 1. –î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É
- ‚úÖ –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ `MANAGER_TG_ID` –∏ `ALLOWED_TG_IDS`
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç: "‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω"
- ‚úÖ –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### 2. Rate Limiting
- ‚úÖ –ú–∞–∫—Å–∏–º—É–º 20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏: "‚è±Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤"
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

### 3. –°–µ–∫—Ä–µ—Ç—ã
- ‚úÖ `.env` –≤ `.gitignore` - –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ Git
- ‚úÖ `.env.example` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
- ‚úÖ –¢–æ–∫–µ–Ω—ã AmoCRM –≤ –ë–î (—É–∂–µ –±—ã–ª–æ)

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- [ ] Input validation (zod schemas)
- [ ] Safe logging (—Å–∫—Ä—ã–≤–∞—Ç—å sensitive –¥–∞–Ω–Ω—ã–µ)
- [ ] Audit logging (–∫—Ç–æ —á—Ç–æ –¥–µ–ª–∞–ª)

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- [ ] Database encryption
- [ ] Webhook –≤–º–µ—Å—Ç–æ polling (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)
- [ ] HTTPS –¥–ª—è webhook
- [ ] Monitoring dashboard

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Auth
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π Telegram –∞–∫–∫–∞—É–Ω—Ç
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É
# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: "‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Rate Limit
```bash
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É 25+ —Å–æ–æ–±—â–µ–Ω–∏–π –±—ã—Å—Ç—Ä–æ
# 21-–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: "‚è±Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ .gitignore
```bash
git add .
git status
# .env –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ tracked files
```

## üìû –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ

### –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã —É—Ç–µ–∫–ª–∏:
1. **–ù–ï–ú–ï–î–õ–ï–ù–ù–û** –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –≤—Å–µ —Ç–æ–∫–µ–Ω—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
3. –£–¥–∞–ª–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Git
4. –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ AmoCRM –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏—è

### –ï—Å–ª–∏ –±–æ—Ç –≤–∑–ª–æ–º–∞–Ω:
1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (`Ctrl+C`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ audit logs –≤ –ë–î
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ Telegram Bot Token
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–ºoCRM

## üéØ –°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: üü° –°–†–ï–î–ù–ò–ô**

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ—Ä—ã, –Ω–æ –µ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è:
- ‚úÖ Auth & Rate Limiting
- ‚úÖ Secrets protected
- ‚ö†Ô∏è –ù–µ—Ç input validation
- ‚ö†Ô∏è –ù–µ—Ç safe logging
- ‚ö†Ô∏è –ù–µ—Ç audit trail

**–¶–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å: üü¢ –í–´–°–û–ö–ò–ô** (—á–µ—Ä–µ–∑ 1-2 –Ω–µ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç—ã)

---

–°–æ–∑–¥–∞–Ω–æ: ${new Date().toLocaleDateString('ru-RU')}
–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${new Date().toLocaleDateString('ru-RU')}
